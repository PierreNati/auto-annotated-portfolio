<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pierre Nativel - Photographe</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo" onclick="showHome()">Pierre Nativel</div>
        <nav>
            <a class="nav-link" onclick="showContact()">Contact</a>
        </nav>
    </header>

    <!-- Home page with independent scrollable albums -->
    <div id="home-page" class="main-content">
        <div class="album-container" id="album-left">
            <div class="album-content" id="album1"></div>
        </div>
        <div class="album-container" id="album-right">
            <div class="album-content" id="album2"></div>
        </div>
    </div>

    <!-- Contact page -->
    <div id="contact-page" class="contact-page">
        <h1 class="contact-title">Contact</h1>
        <div class="contact-content">
            <p>Pour toute demande de collaboration, shooting ou projet photographique, n'hésitez pas à me contacter.</p>
            <p><a href="mailto:pierre.nativel@email.com" class="contact-email">pierre.nativel@email.com</a></p>
            <p>Basé à Rouen, Normandie<br>
            Disponible pour des projets en France et à l'international</p>
        </div>
    </div>

    <script>
        // Sample images with different ratios
        const sampleImages = [
            { url: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=400&h=600&fit=crop', ratio: 0.67 },
            { url: 'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=400&h=300&fit=crop', ratio: 1.33 },
            { url: 'https://images.unsplash.com/photo-1506629905607-45c9e9e94b4e?w=400&h=500&fit=crop', ratio: 0.8 },
            { url: 'https://images.unsplash.com/photo-1494790108755-2616c90a8e6b?w=400&h=600&fit=crop', ratio: 0.67 },
            { url: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=300&fit=crop', ratio: 1.33 },
            { url: 'https://images.unsplash.com/photo-1514315384763-ba401779410f?w=400&h=600&fit=crop', ratio: 0.67 },
            { url: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?w=400&h=400&fit=crop', ratio: 1 },
            { url: 'https://images.unsplash.com/photo-1502823403499-6ccfcf4fb453?w=400&h=500&fit=crop', ratio: 0.8 },
            { url: 'https://images.unsplash.com/photo-1517849845537-4d257902454a?w=400&h=300&fit=crop', ratio: 1.33 },
            { url: 'https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?w=400&h=600&fit=crop', ratio: 0.67 },
            { url: 'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400&h=500&fit=crop', ratio: 0.8 },
            { url: 'https://images.unsplash.com/photo-1501196354995-cbb51c65aaea?w=400&h=300&fit=crop', ratio: 1.33 },
            { url: 'https://images.unsplash.com/photo-1519058082700-08a0b56da9b4?w=400&h=600&fit=crop', ratio: 0.67 },
            { url: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?w=400&h=400&fit=crop', ratio: 1 },
            { url: 'https://images.unsplash.com/photo-1509967419530-da38b4704bc6?w=400&h=500&fit=crop', ratio: 0.8 },
            { url: 'https://images.unsplash.com/photo-1506629905607-45c9e9e94b4e?w=400&h=300&fit=crop', ratio: 1.33 },
            { url: 'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=400&h=600&fit=crop', ratio: 0.67 },
            { url: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=400&h=500&fit=crop', ratio: 0.8 },
            { url: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=300&fit=crop', ratio: 1.33 },
            { url: 'https://images.unsplash.com/photo-1494790108755-2616c90a8e6b?w=400&h=600&fit=crop', ratio: 0.67 }
        ];

        let leftIndex = 0;
        let rightIndex = 10; // Start right album with different images

        function createPhoto(imageData, index) {
            const photo = document.createElement('div');
            photo.className = 'photo';
            
            const img = document.createElement('img');
            img.src = imageData.url;
            img.alt = `Photo ${index + 1}`;
            img.loading = 'lazy';
            
            photo.appendChild(img);
            return photo;
        }

        function loadInitialImages() {
            const album1 = document.getElementById('album1');
            const album2 = document.getElementById('album2');
            
            // Load initial images for left album
            for (let i = 0; i < 8; i++) {
                if (leftIndex < sampleImages.length) {
                    const photo = createPhoto(sampleImages[leftIndex], leftIndex);
                    album1.appendChild(photo);
                    leftIndex++;
                }
            }
            
            // Load initial images for right album
            for (let i = 0; i < 8; i++) {
                if (rightIndex < sampleImages.length) {
                    const photo = createPhoto(sampleImages[rightIndex], rightIndex);
                    album2.appendChild(photo);
                    rightIndex++;
                } else {
                    rightIndex = 0; // Loop back
                    const photo = createPhoto(sampleImages[rightIndex], rightIndex);
                    album2.appendChild(photo);
                    rightIndex++;
                }
            }
        }

        function loadMoreImagesLeft() {
            const album1 = document.getElementById('album1');
            
            for (let i = 0; i < 4; i++) {
                if (leftIndex < sampleImages.length) {
                    const photo = createPhoto(sampleImages[leftIndex], leftIndex);
                    album1.appendChild(photo);
                    leftIndex++;
                } else {
                    leftIndex = 0; // Loop back
                    const photo = createPhoto(sampleImages[leftIndex], leftIndex);
                    album1.appendChild(photo);
                    leftIndex++;
                }
            }
        }

        function loadMoreImagesRight() {
            const album2 = document.getElementById('album2');
            
            for (let i = 0; i < 4; i++) {
                if (rightIndex < sampleImages.length) {
                    const photo = createPhoto(sampleImages[rightIndex], rightIndex);
                    album2.appendChild(photo);
                    rightIndex++;
                } else {
                    rightIndex = 0; // Loop back
                    const photo = createPhoto(sampleImages[rightIndex], rightIndex);
                    album2.appendChild(photo);
                    rightIndex++;
                }
            }
        }

        // Independent scroll handlers
        let isLoadingLeft = false;
        let isLoadingRight = false;

        function handleLeftScroll() {
            if (isLoadingLeft) return;
            
            const container = document.getElementById('album-left');
            const scrollTop = container.scrollTop;
            const scrollHeight = container.scrollHeight;
            const clientHeight = container.clientHeight;
            
            if (scrollTop + clientHeight >= scrollHeight - 1000) {
                isLoadingLeft = true;
                loadMoreImagesLeft();
                setTimeout(() => {
                    isLoadingLeft = false;
                }, 100);
            }
        }

        function handleRightScroll() {
            if (isLoadingRight) return;
            
            const container = document.getElementById('album-right');
            const scrollTop = container.scrollTop;
            const scrollHeight = container.scrollHeight;
            const clientHeight = container.clientHeight;
            
            if (scrollTop + clientHeight >= scrollHeight - 1000) {
                isLoadingRight = true;
                loadMoreImagesRight();
                setTimeout(() => {
                    isLoadingRight = false;
                }, 100);
            }
        }

        // Page navigation
        function showHome() {
            document.getElementById('home-page').style.display = 'flex';
            document.getElementById('contact-page').style.display = 'none';
            
            // Add scroll listeners for both albums
            document.getElementById('album-left').addEventListener('scroll', handleLeftScroll);
            document.getElementById('album-right').addEventListener('scroll', handleRightScroll);
        }

        function showContact() {
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('contact-page').style.display = 'block';
            
            // Remove scroll listeners
            document.getElementById('album-left').removeEventListener('scroll', handleLeftScroll);
            document.getElementById('album-right').removeEventListener('scroll', handleRightScroll);
        }

        // Initialize
        loadInitialImages();
        
        // Add initial scroll listeners
        document.getElementById('album-left').addEventListener('scroll', handleLeftScroll);
        document.getElementById('album-right').addEventListener('scroll', handleRightScroll);

        // Photo click handler
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'IMG' && e.target.closest('.photo')) {
                console.log('Photo clicked:', e.target.src);
            }
        });
    </script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Album scrollable — Grille responsive</title>
<style>
  :root{
    --gap: 10px;
    --cols: 12;           /* nombre de colonnes de la grille */
    --row-size: 8px;      /* hauteur de base des "lignes" de la grille (utilisée pour le calcul de span) */
    --album-width: 1000px; /* largeur max de l'album (pour démo). Peut être 100% */
  }

  body{
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    display: flex;
    justify-content: center;
    padding: 24px;
    background:#f6f6f8;
  }

  .album-wrap{
    width: 100%;
    max-width: var(--album-width);
    border-radius: 10px;
    background: white;
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    padding: 14px;
  }

  .album-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom: 12px;
  }
  .album-header h1{ font-size:18px; margin:0; }
  .controls { font-size:13px; color:#555; }

  /* Grille principale */
  .album{
    height: 70vh;              /* zone scrollable */
    overflow: auto; 
    padding: var(--gap);
    box-sizing: border-box;
    display: grid;
    grid-template-columns: repeat(var(--cols), 1fr);
    grid-auto-rows: var(--row-size); /* base row height used to compute spans */
    grid-auto-flow: dense;
    gap: var(--gap);
    align-items: start;
  }

  .photo{
    position: relative;
    width: 100%;
    overflow: hidden;
    border-radius: 6px;
    background: #eee;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06) inset;
  }

  .photo img{
    display: block;
    width: 100%;
    height: auto; /* conserve le ratio */
    vertical-align: middle;
  }

  /* petit badge pour la démo */
  .meta{
    position:absolute;
    left:8px;
    top:8px;
    background: rgba(0,0,0,0.45);
    color:white;
    padding:4px 6px;
    font-size:12px;
    border-radius:4px;
    pointer-events:none;
  }

  /* Responsive : réduire nombre de colonnes sur petits écrans */
  @media (max-width:900px){
    :root{ --cols: 8; }
  }
  @media (max-width:560px){
    :root{ --cols: 6; --row-size:6px; }
  }
</style>
</head>
<body>

<div class="album-wrap">
  <div class="album-header">
    <h1>Album — scrollable</h1>
    <div class="controls">Colspan = entre 30% et 90% — ratio conservé</div>
  </div>

  <div id="album" class="album">
    <!-- Les éléments photo seront injectés par JavaScript -->
  </div>
</div>

<script>
/*
  Principe :
  - La grille a N colonnes (--cols). On décide pour chaque image d'un 'colSpan' (combien de colonnes elle occupe).
  - ColSpan est choisi pour représenter une largeur entre 30% et 90% de la largeur du conteneur.
  - Après chargement de l'image, on calcule le nombre de "row span" nécessaire pour garder le ratio naturel :
      rowSpan = Math.ceil( (imageHeightOnScreen) / gridAutoRow )
    avec imageHeightOnScreen calculé à partir du ratio naturel et de la largeur effective (colSpan * columnWidth).
  - On applique via style inline : grid-column: span X; grid-row: span Y;
*/

const container = document.getElementById('album');

/* Exemple d'URLs — remplace par tes propres images */
const IMAGES = [
  'https://picsum.photos/id/1015/1400/900',
  'https://picsum.photos/id/1016/1200/1600',
  'https://picsum.photos/id/1025/1200/800',
  'https://picsum.photos/id/1033/800/1200',
  'https://picsum.photos/id/1035/1200/900',
  'https://picsum.photos/id/1040/900/1400',
  'https://picsum.photos/id/1056/1600/1000',
  'https://picsum.photos/id/1060/900/900',
  'https://picsum.photos/id/1069/1200/760',
  'https://picsum.photos/id/1074/900/1300',
  'https://picsum.photos/id/1084/1400/900',
  'https://picsum.photos/id/1080/800/1200'
];

/* Config : largeur min et max en pourcentage de l'album */
const MIN_WIDTH_PERC = 30; // %
const MAX_WIDTH_PERC = 90; // %

/* crée un élément photo et l'insère */
function addPhoto(src, idx){
  const item = document.createElement('div');
  item.className = 'photo';
  // badge démo
  const meta = document.createElement('div');
  meta.className = 'meta';
  meta.textContent = `#${idx+1}`;
  item.appendChild(meta);

  const img = document.createElement('img');
  img.decoding = 'async';
  img.src = src;
  img.alt = 'Photo ' + (idx+1);
  item.appendChild(img);

  // set a temporary size so layout doesn't collapse - we'll adjust after load
  item.style.gridColumn = 'span 4';
  item.style.gridRow = 'span 20';

  container.appendChild(item);

  img.addEventListener('load', () => {
    fitImageToGrid(item, img);
  });

  // handle errors gracefully
  img.addEventListener('error', () => {
    item.style.background = '#ddd';
    meta.textContent = 'erreur';
  });
}

/* Calcule et applique grid spans pour une image */
function fitImageToGrid(item, img){
  // récupérer variables CSS de la grille
  const styles = getComputedStyle(container);
  const cols = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--cols')) || 12;
  const gap = parseFloat(styles.gap) || parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--gap')) || 10;
  const rowSize = parseFloat(styles.gridAutoRows) || parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--row-size')) || 8;

  // largeur du conteneur "inner" (sans padding)
  const rect = container.getBoundingClientRect();
  // calculer width disponible par colonne (on soustrait gaps totaux)
  const totalGapWidth = (cols - 1) * gap;
  const columnWidth = (rect.width - totalGapWidth) / cols;

  // choisir une largeur cible entre MIN% et MAX% de rect.width
  const targetPerc = randomBetween(MIN_WIDTH_PERC, MAX_WIDTH_PERC);
  const targetWidthPx = rect.width * (targetPerc / 100);

  // convertir en nombre de colonnes (au moins 1, max = cols)
  let colSpan = Math.max(1, Math.round(targetWidthPx / (columnWidth + gap))); // arrondir
  colSpan = Math.min(colSpan, cols);

  // si colSpan est 0 (rare), mettre 1
  if (colSpan < 1) colSpan = 1;

  // largeur réelle que l'image occupe = colSpan * columnWidth + (colSpan -1)*gap
  const widthOccupied = colSpan * columnWidth + (colSpan - 1) * gap;

  // ratio naturel de l'image
  const naturalW = img.naturalWidth || img.width;
  const naturalH = img.naturalHeight || img.height;
  const ratio = (naturalH / naturalW) || 1;

  // hauteur en px que prendra l'image à la largeur widthOccupied
  const heightOccupied = widthOccupied * ratio;

  // nombre de rows à span : ceil(heightOccupied / rowSize)
  const rowSpan = Math.max(1, Math.ceil(heightOccupied / rowSize));

  // appliquer les spans
  item.style.gridColumn = `span ${colSpan}`;
  item.style.gridRow = `span ${rowSpan}`;

  // remove explicit inline width/height to let img be responsive
  img.style.width = '100%';
  img.style.height = 'auto';
}

/* helper */
function randomBetween(a, b){
  return Math.floor(Math.random() * (b - a + 1)) + a;
}

/* initialisation : ajout des images */
IMAGES.forEach((url, i) => addPhoto(url, i));

/* On réajuste au redimensionnement (pour recalculer columnWidth & rowSpan) */
let resizeTimer = null;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(() => {
    // recalc pour toutes les images déjà chargées
    const items = container.querySelectorAll('.photo');
    items.forEach(item => {
      const img = item.querySelector('img');
      if (img && img.complete && img.naturalWidth) {
        fitImageToGrid(item, img);
      }
    });
  }, 120);
});
</script>
</body>
</html>
